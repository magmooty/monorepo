FROM golang:1.22

# Install the necessary tools for cross-compilation
RUN apt-get update
RUN apt-get install -y gcc-x86-64-linux-gnu

WORKDIR /app

COPY go.mod go.sum ./

RUN go mod download

CMD ["sh", "-c", "go mod tidy && CGO_ENABLED=1 GOOS=linux GOARCH=amd64 CC=x86_64-linux-gnu-gcc go build -o target/lib/linux-x86_64/libwhatsapp.a -buildmode=c-archive ./pkg/lib/lib.go"]
